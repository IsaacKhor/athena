{% extends "base.html" %}

{% block title %}
  {{assgn.course.code}} {{assgn.code}} - {{assgn.title}}
{% endblock %}

{% block header %}
  {{assgn.course.code}} {{assgn.code}} - {{assgn.title}}
{% endblock %}

{% block breadcrumbs %}
<li><a href={% url 'grader:home' %}>Home</a></li>
<li class='active'>Assignment</li>
{% endblock %}

{% block content %}
  <h1>{{assgn.code}}: {{assgn.title}}</h1>
  <b>Due at: </b> {{assgn.due_date}} <br/>
  <h3>Description</h3>
  {{assgn.desc}}

  {% if student_view %}
  
  <div style='width:600px'>
  <h3>Submit</h3>
  <form method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <table class="table">
      {{ form.as_table }}
    </table>
    <input type="submit" class="btn btn-info" value="Submit" />
  </form>
  </div>
  
  {% if prev_submissions|length > 0 %}
  <div style='width:400px'>
  <h3>Previous Submissions</h3>
  <table class="table">
  <th>Submit Time</th><th>Status</th><th>Download</th>
  {% for s in prev_submissions %}
  <tr>
    <td>{{s.sub_date}}</td>
    <td>{% if s.status == s.CH_GRADED %}Graded{% elif s.status == s.CH_SUBMITTED %}Submitted{% endif %}</td>
    <!--Download option-->
    <td><a class="btn btn-primary btn-sm" href={% url 'grader:submission_download' s.id %}>
      <span class="glyphicon glyphicon-arrow-down"></span>
    </a></td>
  </tr>
  {% endfor %}
  </table>
  </div>
  {% else %}
  <br/>
  You have not submitted anything for this assignment yet
  {% endif %}
  {% endif %}
  
  {% if ta_view or instructor_view %}
  <div style='width:600px'>
  <h2>Submissions</h2>
  <table class="table table-striped">
      <th>Student</th><th>Last Submission</th><th>Status</th><th>Details</th><th>Download</th>
      
  {% for student, recent in recent_subs %}
      <tr valign='center'>
          <td>{{student.first_name}} {{student.last_name}}</td>
          <td>{{recent.sub_date}}</td>
          <td>{% if recent.status == recent.CH_GRADED %}Graded{%else%}Submitted{%endif%}</td>
          
          <!--Details option-->
          <td><a class="btn btn-primary" href={% url 'grader:submissions' assgn.id student.id %}>
            <span class="glyphicon glyphicon-info-sign"></span>
          </td>
          
          <!--Download option-->
          <td><a class="btn btn-primary" href={% url 'grader:submission_download' recent.id %}>
            <span class="glyphicon glyphicon-arrow-down"></span>
          </a></td>
      </tr>
  {% endfor %}
  </table>
  </div>
  {% endif %}

{% endblock %}
